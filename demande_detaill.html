<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Détails de la demande - Sknna.ma</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <link rel="stylesheet" href="style_demande_detaill.css">

</head>
<body>
   <header>
<a href="aceuill.html">
    <img id="siteLogo" src="IMAGES/Logo_mode_light.png" alt="Logo Sknna.ma" class="logo">
</a>

  <nav>
    <ul class="menu">
      <li><a href="logements.html">Logements</a></li>
      <li><a href="Colocation.html">Colocation</a></li>
      <li><a href="publier_annonce.html">Publier une annonce</a></li>
      <li><a href="publier_demande.html">Lancer une demande</a></li>
      <li><a href="Demandes.html">Demandes</a></li>
      <li><a href="contact.html">Contact</a></li>
      <li><a href="presentation.html">Présentation</a></li>
      <li><a href="Se_Connecter.html">Se connecter</a></li>
      <li><a href="creation_Compt.html">S'inscrire</a></li>
    </ul>
  </nav>
  <div class="menu-toggle">
    <i class="fas fa-bars"></i>
  </div>
  
</header>

    <div class="container">
        <a href="Demandes.html" class="back-link"><i class="fas fa-arrow-left"></i> Retour à la liste des demandes</a>
        
        <div id="demandeDetails" class="demande-card">
            <!-- Les détails seront chargés par JavaScript -->
        </div>
    </div>

    <script>
        // header 
          document.addEventListener("DOMContentLoaded", () => {

      const header = document.querySelector("header"); 
      const modeBtn = document.createElement("button");
      modeBtn.id = "darkModeToggle";
      modeBtn.classList.add("dark-toggle-btn"); // ← important !
      modeBtn.innerHTML = `<i class="fa-regular fa-moon"></i>`;
      modeBtn.style.marginLeft = "15px";
      header.appendChild(modeBtn);

      const logo = document.getElementById("siteLogo");

      modeBtn.addEventListener("click", () => {
          document.body.classList.toggle("dark-mode");
          const isDark = document.body.classList.contains("dark-mode");

          modeBtn.innerHTML = isDark 
              ? `<i class="fa-regular fa-sun"></i>`
              : `<i class="fa-regular fa-moon"></i>`;

          logo.src = isDark
              ? "IMAGES/Logo_mode_dark.png"
              : "IMAGES/Logo_mode_light.png";
      });
  });
  //fin header 
  
        document.addEventListener('DOMContentLoaded', function() {
            const demandeDetails = document.getElementById('demandeDetails');
            
            // Récupérer l'ID de la demande depuis l'URL
            const urlParams = new URLSearchParams(window.location.search);
            const demandeId = urlParams.get('id');
            
            // Charger les demandes depuis localStorage
            const demandes = JSON.parse(localStorage.getItem('demandes')) || [];
            
            if (demandeId && demandes[demandeId]) {
                const demande = demandes[demandeId];
                
                // Formater la date
                const date = new Date(demande.date || Date.now());
                const dateStr = date.toLocaleDateString('fr-FR', {day:'2-digit', month:'2-digit', year:'numeric'});
                
                // Créer les badges pour les préférences
                let preferencesHTML = '';
                if (demande.preferences && Array.isArray(demande.preferences)) {
                    preferencesHTML = `
                        <div class="preferences">
                            ${demande.preferences.map(pref => `<div class="preference-tag">${pref}</div>`).join('')}
                        </div>
                    `;
                }
                demandeDetails.innerHTML = `
    <div class="demande-header ${demande.genre && demande.genre.toLowerCase() === 'homme' ? 'homme' : 'femme'}">
        <h1>${demande.prenom || 'Non spécifié'}</h1>
        <div class="age">${demande.age || 'N/A'} ans</div>
    </div>
    
    <div class="demande-content">
        <div class="info-section">
            <h2 class="section-title"><i class="fas fa-user-graduate"></i> Informations personnelles</h2>
            <div class="info-grid">
                <div class="info-item">
                    <i class="fas fa-graduation-cap"></i>
                    <div class="info-label">École:</div>
                    <div>${demande.ecole || 'Non spécifié'}</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-venus-mars"></i>
                    <div class="info-label">Genre:</div>
                    <div>${demande.genre || 'Non spécifié'}</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-envelope"></i>
                    <div class="info-label">Email:</div>
                    <div>${demande.email || 'Non spécifié'}</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-phone"></i>
                    <div class="info-label">Téléphone:</div>
                    <div>${demande.telephone || 'Non spécifié'}</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-city"></i>
                    <div class="info-label">Ville:</div>
                    <div>${demande.ville || 'Non spécifié'}</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-calendar"></i>
                    <div class="info-label">Date de publication:</div>
                    <div>${dateStr}</div>
                </div>
            </div>
        </div>
        
        <div class="budget-section">
            <div class="budget-amount">${demande.budget || 'N/A'} DH</div>
            <div class="budget-label">Budget maximum</div>
            <div class="budget-details">
                <div class="budget-item">
                    <div class="label">Type de logement</div>
                    <div class="value">${demande.typeLogement || 'Non spécifié'}</div>
                </div>
                <div class="budget-item">
                    <div class="label">Colocataires souhaités</div>
                    <div class="value">${demande.nbColoc || 'N/A'}</div>
                </div>
            </div>
        </div>
        
        <div class="info-section">
            <h2 class="section-title"><i class="fas fa-list-check"></i> Préférences</h2>
            ${preferencesHTML}
        </div>
        
        <div class="info-section">
            <h2 class="section-title"><i class="fas fa-pen"></i> Description</h2>
            <div class="description-box">
                <p>${demande.description || 'Aucune description fournie.'}</p>
            </div>
        </div>
        
        <div class="contact-section">
            <a href="mailto:${demande.email || '#'}" class="contact-btn">
                <i class="fas fa-envelope"></i> Contacter ${demande.prenom || 'cette personne'}
            </a>
        </div>
    </div>
`;
            } else {
                demandeDetails.innerHTML = `
                    <div class="demande-header">
                        <h1>Demande non trouvée</h1>
                    </div>
                    <div class="demande-content" style="text-align: center; padding: 40px;">
                        <p>La demande que vous recherchez n'existe pas ou a été supprimée.</p>
                        <a href="Demandes.html" class="contact-btn" style="margin-top: 20px;">
                            <i class="fas fa-arrow-left"></i> Retour à la liste
                        </a>
                    </div>
                `;
            }

            // Menu mobile
            const toggle = document.querySelector(".menu-toggle");
            const nav = document.querySelector("nav");
            if (toggle && nav) {
                toggle.addEventListener("click", () => {
                    nav.classList.toggle("active");
                });
            }
        });
    </script>

</body>
</html>